\title{\textbf{Automatic Projector Tilt Compensation System}}
\author{Ganesh Ajjanagadde \quad James Thomas \quad Shantanu Jain}
\date{\today}
\documentclass{article}

\usepackage{graphicx} % for including images
\usepackage{float} % for floating figures, i.e can place/modify images in fancy ways

%Please place images in img/ subdir of proj_proposal for clean directory structure

\begin{document}
\maketitle

%\begin{abstract}
%Our goal is to design a system that corrects the input to a projector if it is tilted so that its output appears unskewed.
%We will be projecting the display of a PC, and will connect the computer's VGA output to the FPGA board, and the FPGA board's VGA output to the projector.
%We will mount an accelerometer on the projector and measure its signals to determine the projector's tilt angles on two axes.
%We will run algorithms on the FPGA that correct the VGA input based on the tilt angles and produce the results at the VGA output for the projector to display.
%Finally, we will design digital logic that produces a voice specifying the new tilt angles whenever they are changed.
%The project was motivated by the increasing prevalance of portable projectors that benefit from fast automated setup.
%\end{abstract}

\section{Introduction}
Due to the advances in semiconductor technology, today's display projectors can incorporate fairly sophisticated digital processing algorithms for various enhancements to the visual appearance.
Moreover, there is an increasing prevalence of portable projectors that benefit from fast, automated setup.
One desired functionality is keystone/tilt correction.
This means that even when the projector is tilted, the projector is able to ``pre-warp'' the image so that its output appears unskewed.

In this project, we will be projecting the output of a camera, and will connect the camera's output to the FPGA board, and the FPGA board's VGA output to the projector.
We will mount an accelerometer on the projector and measure its signals to determine the projector's tilt angles on two axes.
We will run algorithms on the FPGA that correct the camera output based on the tilt angles and produce the results at the VGA output for the projector to display.
We will calibrate the accelerometer through a special calibration mode.
As a stretch goal, we will also attempt to use the camera combined with the accelerometer itself to calibrate by projecting a known image, such as a white rectangle.
This should result in a gain to the quality of keystone/tilt correction, and one of our goals is to qualitatively observe and quantify such differences in quality.
Finally, we will design digital logic that produces a voice with help commands, and also lets the user know of the new tilt angles whenever they are changed.

\section{Implementation}

\subsection{Block Diagram}
\includegraphics[width=\textwidth]{img/block_diag}

\subsection{Modules}

\subsubsection{Accelerometer}
The accelerometer is an Analog Devices 3 axis accelerometer ADXL362.
The ADXL362 gives acceleration values at an 8 bit resolution, and is controlled via a SPI interface.
Thus, this module will implement the appropriate SPI interface so as to make the raw data available to the FPGA.
Unfortunately, this data is extremely noisy.
As such, this module will also implement a low-pass filter in order to suppress this noise.
For simplicity, we will use a moving average filter.

\subsubsection{Tilt Angle Estimation Engine}
The tilt estimation engine will accept a calibration input (e.g a button) in order to normalize the accelerometer readings based on the values for zero tilt.
Basically, it subtracts off the readings for a neutral position in order to get a consistent value for the tilt reading.

\subsubsection{Audio}
The audio module will read audio from the stored compact flash and will play the appropriate audio depending on the input signal to the module.
For instance, when the user requests help regarding calibration via pressing the appropriate button,
it goes into a state in which it does a looping playback instructing the user how to adjust the projector so that the output appears unskewed.
When a change in tilt is detected,
the percentage of pixels lost due to the ``pre-warping'' will change and the audio enine will play a recording specifying the new percentage.
Other audio will be added/updated as needed as our user interface changes.

\subsubsection{Frame correction system}
The frame correction system will be responsible for ``pre-warping'' the image based on the current accelerometer readings from the tilt estimation engine.
The camera output is stored in a ZBT buffer, and is updated on every NTSC clock cycle.
The ``pre-warping'' transformation (mathematically a perspective transform) is computed in a ZBT scratch buffer.
The output frame from the ``pre-warping'' is stored in a ZBT display buffer.
An auxiliary module will then feed the pixels in the display buffer to the VGA output at the appropriate vsync clock edge.

\section{Timeline}
% TODO: Add Gantt chart/graphical timeline (Shawn)
There is five weeks time in which to complete the project. In these five weeks, we envision four major stages to the project:
\begin{enumerate}
	\item Initial attempt at implementing each block \hfill \\
		Time: 2 weeks \hfill \\
		In this stage, each team member will create an initial implementation of modules he is responsible for. He is expected to have his modules working as a standalone component. Each module will include simple test benches in order to facilitate this goal.
	\item Module Integration; System Building \hfill \\
		Time: 2 weeks \hfill \\
		This stage will connect the individual modules from stage 1 together to form the initial system. This is expected to be the most hands-on and collaborative stage, as mistakes will often have a domino effect on the system. In the worst case, we may have to modify parts of our system design or change the behavior of some modules in order to compensate; in lesser situations, bugs may be uncovered and fixed. This is expected to be the lengthiest stage.
	\item Intensive debugging \hfill \\
		Time: 1 week \hfill \\
		After the system has been put together and functions minimally, the team will focus on debugging. The goal of debugging is to make the system robust. Testing will include the common usage scenarios as well as edge cases, and a limited set of malicious inputs.
	\item Stretch Goals \hfill \\
		Time: As available \hfill \\
		Once the system satisfies the test coverage plan, the team will focus on adding additional features to the system, as constrained by time. These possible additional features are described below.

\end{enumerate}

\section{Individual Responsibility}
\begin{description}
	\item{Ganesh}
	\begin{itemize}
		\item Algorithm - Identifying the appropriate algorithm, considering factors of complexity, hardware constraints, and implementability.
		\item Transform Module - Implementing the algorithm, with input parameters
	\end{itemize}
	\item{James}
	\begin{itemize}
		\item Accelerometer - Identifying the appropriate type and model, interfacing with the labkit.
		\item Calibration module - Entering calibration mode, collecting data, making it available as necessary.
	\end{itemize}
	\item{Shantanu}
	\begin{itemize}
		\item Audio output - Identifying necessary audio outputs, triggers for audio. Recording audio, transforming it into the appropriate format.
		\item Audio module - loading audio onto the labkit, standardizing trigger parameters.
		\item Test Setup - attaching accelerometer to projector, wiring to labkit.
	\end{itemize}
\end{description}

\section{Stretch Goals}
	\begin{itemize}
		\item Camera-based adjustment \hfill \\
			The camera-based adjustment would augment the accelerometer by displaying a test pattern output to the projector and using an edge detection/corner detection algorithm to determine the skew caused by the projector's tilt. It would be able to correct the projector image in a wider variety of scenarios, including variable distance to the screen. This is difficult as it is complex and time consuming to interface the camera with the labkit and implement these additional algorithms.
		\item External display of transformed image\hfill \\
			View the transformed image on a non-distorted screen, such as a PC LCD monitor.
	\end{itemize}
\end{document}
